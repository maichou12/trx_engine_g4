spring.application.name=trx_engine_g4

# --- PostgreSQL Datasource ---
spring.datasource.url=jdbc:postgresql://localhost:5432/trx_engine_g4
spring.datasource.username=postgres
spring.datasource.password=passer
spring.datasource.driver-class-name=org.postgresql.Driver

# --- JPA / Hibernate ---
spring.jpa.show-sql=true
spring.jpa.hibernate.ddl-auto=update
spring.jpa.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.properties.hibernate.format_sql=true


# --- keycloak ---
server.port=8080
#keycloak.client-id=trx-engine-g4-client
keycloak.client-id=trx-engine-client
keycloak.realm=trx-realm
keycloak.auth-server-url=http://localhost:9080
keycloak.resource=trx-engine-client
keycloak.client-key-password=fTa7dUd2XWsHVSlCgpvRijGszylTiKZ0
keycloak.admin-client-secret=fTa7dUd2XWsHVSlCgpvRijGszylTiKZ0
keycloak.public-client=false
keycloak.bearer-only=true
keycloak.admin.username=admin
keycloak.admin.password=admin

# --- Configuration OAuth2 (Nouveau) ---
# Ceci remplace l'ancienne section 'keycloak.*'

# 1. URI de l'émetteur (Issuer URI) : C'est l'URL de base pour la configuration OIDC de Keycloak.
# Elle est utilisée par Spring Security pour découvrir les métadonnées (comme l'URL des JWKS).
spring.security.oauth2.resourceserver.jwt.issuer-uri=http://localhost:9080/realms/trx_engine_g4
spring.security.oauth2.resourceserver.jwk-set-uri=http://localhost:9080/realms/trx_engine_g4/protocol/openid-connect/certs
# 2. Audience (facultatif, mais bonne pratique) : Permet de valider que le token est destiné à cette application (le 'resource' de Keycloak)
# La validation se base sur le champ 'aud' (audience) dans le JWT.
# Assurez-vous que cette valeur correspond au Client ID (keycloak.resource) dans Keycloak.
spring.security.oauth2.resourceserver.jwt.audience=trx-engine-g4-client

# 3. Activation du Resource Server (souvent implicite si la dépendance est présente, mais explicite pour la clarté)
# Pour une application "Bearer-only" agissant comme un Resource Server (API)
# C'est l'équivalent du keycloak.bearer-only=true
spring.security.oauth2.resourceserver.jwt.enabled=true


logging.level.org.springframework.web=DEBUG
logging.level.org.springframework.validation=DEBUG
keycloak.use-resource-role-mappings=true
